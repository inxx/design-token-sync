name: Create PR for Design Token

on:
  repository_dispatch:
    types: [update-design-tokens]

jobs:
  create-pr:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}

    - name: Set safe.directory
      run: |
        git config --global --add safe.directory /home/runner/work/design-token-sync/design-token-sync

    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v5
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: 'feat: update design tokens'
        title: '디자인 토큰 자동 업데이트'
        body: |
          업로드된 디자인 토큰으로 자동 생성된 PR입니다.

          트리거 시간: ${{ github.event.client_payload.timestamp }}
          브랜치: ${{ github.event.client_payload.branch }}
          메시지: ${{ github.event.client_payload.message }}
        branch: ${{ github.event.client_payload.branch }}
        base: main
        delete-branch: true 